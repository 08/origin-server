#!/bin/bash -e
set -x

OPENSHIFT_RUBY_DIR="$OPENSHIFT_HOMEDIR/ruby"

# Parse arguments
source "${OPENSHIFT_RUBY_DIR}/lib/util"
parse_args $@

# Set default version
version=1.9
<<<<<<< HEAD
=======

# Don't set -u until after the above arg parsing is complete
set -u

ls -lZa $OPENSHIFT_HOMEDIR/ruby
id
>>>>>>> Added setup parsing

# Copy the version specific files to ruby directory
<<<<<<< HEAD
<<<<<<< HEAD
for dir in etc metadata template; do
	mkdir -p $OPENSHIFT_RUBY_DIR/$dir
	cp -r $OPENSHIFT_RUBY_DIR/versions/$version/$dir/* $OPENSHIFT_RUBY_DIR/$dir 
done
=======
OPENSHIFT_RUBY_DIR="$OPENSHIFT_HOMEDIR/ruby"
=======
>>>>>>> moving argument parsing to util
cp -Lr $OPENSHIFT_RUBY_DIR/versions/$version/etc/* $OPENSHIFT_RUBY_DIR/etc
cp -Lr $OPENSHIFT_RUBY_DIR/versions/$version/metadata/* $OPENSHIFT_RUBY_DIR/metadata
cp -Lr $OPENSHIFT_RUBY_DIR/versions/$version/template/* $OPENSHIFT_RUBY_DIR/template
>>>>>>> Force follow reference

# Create additional directories required by RUBY and httpd
ln -s /usr/lib64/httpd/modules $OPENSHIFT_RUBY_DIR
ln -s /etc/httpd/conf/magic $OPENSHIFT_RUBY_DIR/etc/magic

